
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>Maksim&#39;s Website</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Maksim">
    

    
    <meta property="og:type" content="website">
<meta property="og:title" content="Maksim&#39;s Website">
<meta property="og:url" content="http://www.maksim.website/page/5/index.html">
<meta property="og:site_name" content="Maksim&#39;s Website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Maksim&#39;s Website">

    
    <link rel="alternative" href="/atom.xml" title="Maksim&#39;s Website" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Maksim&#39;s Website" title="Maksim&#39;s Website"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Maksim&#39;s Website">Maksim&#39;s Website</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:www.maksim.website">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/09/16/1/" title="大事务对MySQL性能带来的影响" itemprop="url">大事务对MySQL性能带来的影响</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-09-15T16:00:00.000Z" itemprop="datePublished"> Published 2017-09-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>在我们的日常开发过程当中，为了保持数据的一致性，多多少少都会用到事务。</p>
<p>当面对大量数据时，使用事务一定要谨小慎微，因为一旦编写的事务中设计的数据量过大，就会严重的影响系统性能，如果操作的数据量特别巨大，则会造成服务器的阻塞，导致业务逻辑无法访问。</p>
<h3 id="什么是事务？"><a href="#什么是事务？" class="headerlink" title="什么是事务？"></a>什么是事务？</h3><p>在了解大事务对 MySQL 性能带来的影响之前，我们首先要了解什么是事务，事务又起到了什么样的作用：</p>
<ol>
<li><p>事务是关系型数据库系统区分于其他一切文件系统的重要特性，举例说明，对于文件系统来说，为了保证两个文件的一致，在我们修改完一个文件后，系统突然崩溃，这样文件系统在恢复后就很难保持系统的一致了，而数据库系统中，由于使用了事务，在数据库崩溃后，我们可以恢复数据库中的数据，使其保证数据的一致性。</p>
</li>
<li><p>事务是一组具有原子性的SQL语句，或是一个单独的工作单元，事务处理中只有两种可能性，事务处理成功，事务处理失败，一旦失败，数据库就会回滚到原始状态。</p>
</li>
</ol>
<p>事务要符合：原子性、一致性、隔离性、持久性</p>
<h4 id="事务的原子性（ATOMICITY）"><a href="#事务的原子性（ATOMICITY）" class="headerlink" title="事务的原子性（ATOMICITY）"></a>事务的原子性（ATOMICITY）</h4><p>定义：一个事务必须被诗作为一个不可分割的最小工作单元，整个事务中的所有操作要么全部提交完成，要么全部失败，对于一个事物来说，不可能只执行其中的一部分操作。</p>
<p>举个例子（银行），我们有两个账户，一个是理财账户，另外一个是活期存款账户，现在需要从理财账户中转出2000RMB到活期存款账户中，我们需要经过以下步骤。</p>
<ol>
<li>检查理财账户中的余额是否高于2000RMB</li>
<li>从理财账户的余额中减去2000RMB</li>
<li>在活期存款账户中增加2000RM</li>
</ol>
<p>以上步骤必须作为一个整体一起完成，如果运行到第二步骤时系统崩溃，如果没有事务原子性这一特性，用户将损失两千元，这是无法接受的一件事情。</p>
<p>在事务中执行到第二步崩溃时，在系统恢复后，在日志中有没有完成提交的事务，系统就会回滚，避免了用户的损失。</p>
<p>整个事务中所有操作要么全部提交成功，要么全部失败回滚。</p>
<h4 id="事务的一致性（CONSISTENCY）"><a href="#事务的一致性（CONSISTENCY）" class="headerlink" title="事务的一致性（CONSISTENCY）"></a>事务的一致性（CONSISTENCY）</h4><p>定义：一致性是指事务将数据库从一种一致性状态转换到另外一种一致性状态，在事务开始之前和事务结束后数据库中数据的完整性没有被破坏。</p>
<h4 id="事务的隔离性（ISOLATION）"><a href="#事务的隔离性（ISOLATION）" class="headerlink" title="事务的隔离性（ISOLATION）"></a>事务的隔离性（ISOLATION）</h4><p>定义： 隔离性要求一个事务对数据库中数据的修改，在未提交完成前对于其他事务是不可见的。</p>
<p>SQL标准中定义的四种隔离级别</p>
<ul>
<li>未提交读（READ UNCOMMITED）</li>
<li>已提交读（READ COMMITED）</li>
<li>可重复读（REPEATABLE READ）</li>
<li>可串行化（SERIALIZABLE）</li>
</ul>
<h4 id="事务的持久性（DURABILITY）"><a href="#事务的持久性（DURABILITY）" class="headerlink" title="事务的持久性（DURABILITY）"></a>事务的持久性（DURABILITY）</h4><p>定义：一旦事务提交，则其所做的修改就会永久</p>
<p>的保存到数据库中，即使此时系统崩溃，已经提交的修改数据也不会丢失。</p>
<h3 id="什么是大事务"><a href="#什么是大事务" class="headerlink" title="什么是大事务"></a>什么是大事务</h3><p>定义：运行时间比较长，操作数据比较多的事务。</p>
<p>余额宝这样的理财产品，每天都会计算前一天的理财收入所得，如果在一个事务中对所有的用户的理财收入都进行计算，并更新到用户余额中，这样数以亿计的用户余额的更新就要数个小时，而且一旦中间出现问题就会回滚，时间会更长。</p>
<p>这时一旦出现问题，数据库就会加锁，造成用户无法使用余额的问题。</p>
<p>风险：</p>
<ol>
<li>锁定太多的数据，造成大量的阻塞和锁超时，对于innodb为了保证数据的一致性，虽然是行级锁，但是也会把所有相关的记录都加上锁。</li>
<li>回滚所需要的时间比较长，回滚时数据仍然会被锁定。</li>
<li>执行时间长，容易造成主从延迟。</li>
</ol>
<h3 id="如何处理大事务"><a href="#如何处理大事务" class="headerlink" title="如何处理大事务"></a>如何处理大事务</h3><ol>
<li>避免一次处理太多数据,当面临成百上千万的数据量时，我们最好分批进行处理，例如每一个事务处理一万条数据。</li>
<li>移出不必要在事务中的SELECT操作。</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/MySQL/">MySQL</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/09/10/1/" title="MySQL主从数据库" itemprop="url">MySQL主从数据库</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-09-09T16:00:00.000Z" itemprop="datePublished"> Published 2017-09-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="什么是mysql主从同步？"><a href="#什么是mysql主从同步？" class="headerlink" title="什么是mysql主从同步？"></a>什么是mysql主从同步？</h2><p>当master(主)库的数据发生变化的时候，变化会实时的同步到slave(从)库。</p>
<p>##主从同步有什么好处？</p>
<ul>
<li>水平扩展数据库的负载能力。</li>
<li>容错，高可用。Failover(失败切换)/High Availability</li>
<li>数据备份。</li>
</ul>
<h2 id="主从同步的原理是什么？"><a href="#主从同步的原理是什么？" class="headerlink" title="主从同步的原理是什么？"></a>主从同步的原理是什么？</h2><p>首先我们来了解<strong>master-slave</strong>的体系结构。</p>
<p>如下图：<br><img src="https://segmentfault.com/img/remote/1460000008663004?w=601&amp;h=152" alt="img"></p>
<p>不管是delete、update、insert，还是创建函数、存储过程，所有的操作都在master上。<br>当master有操作的时候,slave会快速的接收到这些操作，从而做同步。</p>
<p>但是，这个机制是怎么实现的呢？</p>
<blockquote>
<p>在master机器上，主从同步事件会被写到特殊的log文件中(binary-log);<br>在slave机器上，slave读取主从同步事件，并根据读取的事件变化，在slave库上做相应的更改。</p>
</blockquote>
<p>如此，就实现了主从同步了！</p>
<p>下面我们来详细的了解。</p>
<h3 id="主从同步事件有哪些"><a href="#主从同步事件有哪些" class="headerlink" title="主从同步事件有哪些"></a>主从同步事件有哪些</h3><p>上面说到：</p>
<blockquote>
<p>在master机器上，主从同步事件会被写到特殊的log文件中(binary-log);</p>
</blockquote>
<p>主从同步事件有3种形式:statement、row、mixed。</p>
<ul>
<li>statement：会将对数据库操作的sql语句写入到binlog中。</li>
<li>row：会将每一条数据的变化写入到binlog中。</li>
<li>mixed：statement与row的混合。Mysql决定什么时候写statement格式的，什么时候写row格式的binlog。</li>
</ul>
<h3 id="在master机器上的操作"><a href="#在master机器上的操作" class="headerlink" title="在master机器上的操作"></a>在master机器上的操作</h3><ul>
<li>当master上的数据发生改变的时候，该事件(insert、update、delete)变化会按照顺序写入到binlog中。</li>
</ul>
<h4 id="binlog-dump线程"><a href="#binlog-dump线程" class="headerlink" title="binlog dump线程"></a>binlog dump线程</h4><ul>
<li>当slave连接到master的时候，master机器会为slave开启binlog dump线程。</li>
<li>当master 的 binlog发生变化的时候，binlog dump线程会通知slave，并将相应的binlog内容发送给slave。</li>
</ul>
<h3 id="在slave机器上的操作"><a href="#在slave机器上的操作" class="headerlink" title="在slave机器上的操作"></a>在slave机器上的操作</h3><p>当主从同步开启的时候，slave上会创建2个线程。</p>
<ul>
<li>I/O线程。该线程连接到master机器，master机器上的<strong>binlog dump线程</strong>会将binlog的内容发送给该<strong>I/O线程</strong>。该<strong>I/O线程</strong>接收到binlog内容后，再将内容写入到本地的relay log。</li>
<li>SQL线程。该线程读取I/O线程写入的relay log。并且根据relay log的内容对slave数据库做相应的操作。</li>
</ul>
<h3 id="如何在master、slave上查看上述的线程？"><a href="#如何在master、slave上查看上述的线程？" class="headerlink" title="如何在master、slave上查看上述的线程？"></a>如何在master、slave上查看上述的线程？</h3><p>使用<code>SHOW PROCESSLIST</code>命令可以查看。</p>
<p>如图，在master机器上查看binlog dump线程。<br><img src="https://segmentfault.com/img/remote/1460000008663005?w=604&amp;h=448" alt="img"></p>
<p>如图，在slave机器上查看I/O、SQL线程。<br><img src="https://segmentfault.com/img/remote/1460000008663006?w=626&amp;h=592" alt="img"></p>
<h2 id="讲了这么多，一图以蔽之"><a href="#讲了这么多，一图以蔽之" class="headerlink" title="讲了这么多，一图以蔽之"></a>讲了这么多，一图以蔽之</h2><p><img src="https://segmentfault.com/img/remote/1460000008663007?w=630&amp;h=568" alt="img"></p>
<h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">os:ubuntu16.04</div><div class="line">mysql:5.7.17</div><div class="line"></div><div class="line">master IP:192.168.33.22</div><div class="line">slave  IP:192.168.33.33</div></pre></td></tr></table></figure>
<h3 id="master机器上的操作"><a href="#master机器上的操作" class="headerlink" title="master机器上的操作"></a>master机器上的操作</h3><h4 id="1、更改配置文件"><a href="#1、更改配置文件" class="headerlink" title="1、更改配置文件"></a>1、更改配置文件</h4><p>我们找到文件 <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>。<br>配置如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">bind-address = 192.168.33.22 #your master ip</div><div class="line">server-id = 1 #在master-slave架构中，每台机器节点都需要有唯一的server-id</div><div class="line">log_bin = /var/log/mysql/mysql-bin.log #开启binlog</div></pre></td></tr></table></figure>
<h4 id="2、重启MySQL"><a href="#2、重启MySQL" class="headerlink" title="2、重启MySQL"></a>2、重启MySQL</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo systemctl restart mysql</div></pre></td></tr></table></figure>
<h4 id="3、创建主从同步的mysql-user。"><a href="#3、创建主从同步的mysql-user。" class="headerlink" title="3、创建主从同步的mysql user。"></a>3、创建主从同步的mysql user。</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">$</span> mysql -u root -p</div><div class="line">Password:</div><div class="line"><span class="meta"></span></div><div class="line">##创建slave1用户，并指定该用户只能在主机192.168.33.33上登录。</div><div class="line"><span class="meta">mysql&gt;</span> CREATE USER 'slave1'@'192.168.33.33' IDENTIFIED BY 'slavepass';</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line"><span class="meta"></span></div><div class="line">##为slave1赋予REPLICATION SLAVE权限。</div><div class="line"><span class="meta">mysql&gt;</span> GRANT REPLICATION SLAVE ON *.* TO 'slave1'@'192.168.33.33';</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>
<h4 id="4、为MYSQL加读锁"><a href="#4、为MYSQL加读锁" class="headerlink" title="4、为MYSQL加读锁"></a>4、为MYSQL加读锁</h4><p>为了主库与从库的数据保持一致，我们先为mysql加入读锁，使其变为只读。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; FLUSH TABLES WITH READ LOCK;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>
<h4 id="5、记录下来MASTER-REPLICATION-LOG-的位置"><a href="#5、记录下来MASTER-REPLICATION-LOG-的位置" class="headerlink" title="5、记录下来MASTER REPLICATION LOG 的位置"></a>5、记录下来MASTER REPLICATION LOG 的位置</h4><p>该信息稍后会用到。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SHOW MASTER STATUS;</div><div class="line">+------------------+----------+--------------+------------------+-------------------+</div><div class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</div><div class="line">+------------------+----------+--------------+------------------+-------------------+</div><div class="line">| mysql-bin.000001 |      613 |              |                  |                   |</div><div class="line">+------------------+----------+--------------+------------------+-------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure>
<h4 id="6、将master-DB中现有的数据信息导出"><a href="#6、将master-DB中现有的数据信息导出" class="headerlink" title="6、将master DB中现有的数据信息导出"></a>6、将master DB中现有的数据信息导出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ mysqldump -u root -p --all-databases --master-data &gt; dbdump.sql</div></pre></td></tr></table></figure>
<h4 id="7、接触master-DB的读锁"><a href="#7、接触master-DB的读锁" class="headerlink" title="7、接触master DB的读锁"></a>7、接触master DB的读锁</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; UNLOCK TABLES;</div></pre></td></tr></table></figure>
<h4 id="8、将步骤6中的dbdump-sql文件copy到slave"><a href="#8、将步骤6中的dbdump-sql文件copy到slave" class="headerlink" title="8、将步骤6中的dbdump.sql文件copy到slave"></a>8、将步骤6中的dbdump.sql文件copy到slave</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp dbdump.sql ubuntu@192.168.33.33:/home/ubuntu</div></pre></td></tr></table></figure>
<h3 id="slave机器上的操作"><a href="#slave机器上的操作" class="headerlink" title="slave机器上的操作"></a>slave机器上的操作</h3><h4 id="1、更改配置文件-1"><a href="#1、更改配置文件-1" class="headerlink" title="1、更改配置文件"></a>1、更改配置文件</h4><p>我们找到文件 <code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>。<br>更改配置如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">bind-address = 192.168.33.33 #your slave ip</div><div class="line">server-id = 2 #master-slave结构中，唯一的server-id</div><div class="line">log_bin = /var/log/mysql/mysql-bin.log #开启binlog</div></pre></td></tr></table></figure>
<h4 id="2、重启mysql，以使配置文件生效"><a href="#2、重启mysql，以使配置文件生效" class="headerlink" title="2、重启mysql，以使配置文件生效"></a>2、重启mysql，以使配置文件生效</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo systemctl restart mysql</div></pre></td></tr></table></figure>
<h4 id="3、导入从master-DB。-导出的dbdump-sql文件，以使master-slave数据一致"><a href="#3、导入从master-DB。-导出的dbdump-sql文件，以使master-slave数据一致" class="headerlink" title="3、导入从master DB。 导出的dbdump.sql文件，以使master-slave数据一致"></a>3、导入从master DB。 导出的dbdump.sql文件，以使master-slave数据一致</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ mysql -u root -p &lt; /home/ubuntu/dbdump.sql</div></pre></td></tr></table></figure>
<h4 id="4、使slave与master建立连接，从而同步"><a href="#4、使slave与master建立连接，从而同步" class="headerlink" title="4、使slave与master建立连接，从而同步"></a>4、使slave与master建立连接，从而同步</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ mysql -u root -p</div><div class="line">Password:</div><div class="line"></div><div class="line">mysql&gt; STOP SLAVE;</div><div class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; CHANGE MASTER TO</div><div class="line">    -&gt; MASTER_HOST=&apos;192.168.33.22&apos;,</div><div class="line">    -&gt; MASTER_USER=&apos;slave1&apos;,</div><div class="line">    -&gt; MASTER_PASSWORD=&apos;slavepass&apos;,</div><div class="line">    -&gt; MASTER_LOG_FILE=&apos;mysql-bin.000001&apos;,</div><div class="line">    -&gt; MASTER_LOG_POS=613;</div><div class="line">Query OK, 0 rows affected, 2 warnings (0.01 sec)</div><div class="line"></div><div class="line">mysql&gt; START SLAVE;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div></pre></td></tr></table></figure>
<p><code>MASTER_LOG_FILE=&#39;mysql-bin.000001&#39;</code>与<code>MASTER_LOG_POS=613</code>的值，是从上面的 <code>SHOW MASTER STATUS</code> 得到的。</p>
<p>经过如此设置之后，就可以进行master-slave同步了~</p>
<h2 id="PHP代码实现数据库读写分离"><a href="#PHP代码实现数据库读写分离" class="headerlink" title="PHP代码实现数据库读写分离"></a>PHP代码实现数据库读写分离</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Db</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> $res;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($sql)</span></span></div><div class="line">    &#123;</div><div class="line">        $querystr = strtolower(trim(substr($sql,<span class="number">0</span>,<span class="number">6</span>)));</div><div class="line">        <span class="comment">//如果是select，就连接slave服务器</span></div><div class="line">        <span class="keyword">if</span>($querystr == <span class="string">'select'</span>)</div><div class="line">        &#123;</div><div class="line">            $res=<span class="keyword">$this</span>-&gt;slave_select($sql);</div><div class="line">            <span class="keyword">$this</span>-&gt;res=$res;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//如果不是select，就连接master服务器</span></div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            $res=<span class="keyword">$this</span>-&gt;master_change($sql);</div><div class="line">            <span class="keyword">$this</span>-&gt;res=$res;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * slave从库返回sql查询结果</div><div class="line">     * <span class="doctag">@param</span> $sql</div><div class="line">     * <span class="doctag">@return</span> array</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">slave_select</span><span class="params">($sql)</span></span>&#123;</div><div class="line">        <span class="comment">//该处只是随机获取slave节点的ip，当然，还可以采用其他算法获取slave_ip</span></div><div class="line">        $slave_server=<span class="keyword">$this</span>-&gt;get_slave_ip();</div><div class="line">        $dsn=<span class="string">"mysql:host=$slave_server;dbname=test"</span>;</div><div class="line">        $user=<span class="string">'root'</span>;</div><div class="line">        $pass=<span class="string">'123456'</span>;</div><div class="line">        $dbh=<span class="keyword">new</span> PDO($dsn, $user, $pass);</div><div class="line">        <span class="keyword">return</span> $dbh-&gt;query($sql)-&gt;fetchAll(PDO::FETCH_ASSOC);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**master主库返回sql执行结果</span></div><div class="line">     * <span class="doctag">@param</span> $sql</div><div class="line">     * <span class="doctag">@return</span> int</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">master_change</span><span class="params">($sql)</span></span>&#123;</div><div class="line">        $master_server=<span class="string">'192.168.33.22'</span>;</div><div class="line">        $dsn=<span class="string">"mysql:host=$master_server;dbname=test"</span>;</div><div class="line">        $user=<span class="string">'root'</span>;</div><div class="line">        $pass=<span class="string">'123456'</span>;</div><div class="line">        $dbh=<span class="keyword">new</span> PDO($dsn, $user, $pass);</div><div class="line">        <span class="keyword">return</span> $dbh-&gt;exec($sql);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 随机获取slave-ip</div><div class="line">     * <span class="doctag">@return</span> mixed</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">get_slave_ip</span><span class="params">()</span></span>&#123;</div><div class="line">        $slave_ips=[<span class="string">'192.168.33.33'</span>,<span class="string">'192.168.33.44'</span>];</div><div class="line">        $count=count($slave_ips)<span class="number">-1</span>;</div><div class="line">        $random_key=mt_rand(<span class="number">0</span>,$count);</div><div class="line">        <span class="keyword">return</span> $slave_ips[$random_key];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 获取结果</div><div class="line">     * <span class="doctag">@return</span> int</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_res</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;res;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$sql1 = <span class="string">"select * from t1"</span>;</div><div class="line">$sql2 = <span class="string">"insert into t1 (name) values ('haha')"</span>;</div><div class="line">$sql3 = <span class="string">"delete from t1 where id=1"</span>;</div><div class="line">$sql4 = <span class="string">"update t1 set name='Jerry' where id=2"</span>;</div><div class="line"></div><div class="line">$db = <span class="keyword">new</span> Db($sql1);</div><div class="line"><span class="comment">//$db = new Db($sql2);</span></div><div class="line"><span class="comment">//$db = new Db($sql3);</span></div><div class="line"><span class="comment">//$db = new Db($sql4);</span></div><div class="line"></div><div class="line">var_dump($db-&gt;get_res());</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/PHP/">PHP</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/09/05/1/" title="法律结构条、款、项、目" itemprop="url">法律结构条、款、项、目</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-09-04T16:00:00.000Z" itemprop="datePublished"> Published 2017-09-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>公司的新项目上线了，我们要为律师团队开发一套内部系统，其中包括爬虫抓来的问答、法律条款的检索。</p>
<p>而法律条文不能直接以文章的形式存储，因为后期可能会涉及到法律条文的引用，例如：</p>
<p><em>《烟草专卖法》第二条第二款</em></p>
<p>一般来讲，一件(部)法律由章、节、条、款、项、目组成，个别重要的法典还分编。</p>
<p>编、章、节是对法条的归类，所以，在适用法律时只需引用到条、款、项、目即可，无需指出该条所在的编、章、节。因此，弄懂法律规范中条、款、项、目的含义，在执法活动中正确适用法律规范的条、款、项、目，对于规范执法行为，提高执法质量是大有益处的。</p>
<h2 id="一、“条”"><a href="#一、“条”" class="headerlink" title="一、“条”"></a>一、“条”</h2><h3 id="1-条的概念"><a href="#1-条的概念" class="headerlink" title="1. 条的概念"></a>1. 条的概念</h3><p>法律规范的“条”，又称“法条”，是组成法律规范的基本单位。一部法律，都是由若干法条组成的。如《烟草专卖法》由46个法条组成，《烟草专卖法实施条例》由70个法条组成。</p>
<p>法律规范的“条”，是法律规范对某一个具体法律问题的完整规定，如：</p>
<blockquote>
<p>《烟草专卖法》第三十条  违反本规定擅自收购烟叶的，由烟草专卖行政主管部门处以罚款，并按照国家规定的价格收购违法收购的烟叶；数量巨大的，没收违法收购的烟叶和违法所得。</p>
</blockquote>
<p> 这一条就是对擅自收购烟叶法律责任的完整规定。</p>
<p>###　2. 条的书写</p>
<p>​    一般来讲，条的数目的书写应使用中文，如《烟草专卖法》第三十条。但也有使用阿拉伯数字的，如《烟草专卖法》第30条。</p>
<p>​    执法活动中，对一个涉法问题作出决定时，可能要适用多个法条。如对无证运输的人进行处罚时，应同时适用《烟草专卖法》第三十一条第一款、《条例》第五十五条第一项和第六十九条的规定。</p>
<h2 id="二、“款”"><a href="#二、“款”" class="headerlink" title="二、“款”"></a>二、“款”</h2><h3 id="1-款的概念。"><a href="#1-款的概念。" class="headerlink" title="1. 款的概念。"></a>1. 款的概念。</h3><p> “款”是“条”的组成部分。在一般情况下，每一款都是一个独立的内容或是对其前一款内容的补充表述。如：</p>
<blockquote>
<p>《烟草专卖法》第二条　</p>
<p>本法所称烟草专卖品是指卷烟、雪茄烟、烟丝、复烤烟叶、烟叶、卷烟纸、滤嘴棒、烟用丝束、烟草专用机械。</p>
<p><em>卷烟、雪茄烟、烟丝复烤烟叶统称烟草制品。</em></p>
</blockquote>
<p>《烟草专卖法》第二条有二款。其中第一款界定了烟草专卖品的范围，第二款进一步界定了烟草制品的范围。</p>
<h3 id="2-款的表现形式。"><a href="#2-款的表现形式。" class="headerlink" title="2. 款的表现形式。"></a>2. 款的表现形式。</h3><p>“款”的表现形式为条中的自然段，每个自然段为一款。</p>
<p>“款”前不冠以数字以排列其顺序。如《烟草专卖法》第二条的两款，款前均无数字。有数字排列的不称为款。如：</p>
<blockquote>
<p>《条例》第七条取得烟草专卖生产企业许可证，应当具备下列条件：</p>
<p>(一)有与生产烟草专卖品相适应的资金；</p>
<p>(二)有生产烟草专卖品所需要的技术、设备条件；</p>
<p>(三)符合国家烟草行业的产业政策要求；</p>
<p>(四)国务院烟草专卖行政主管部门规定的其他条件。</p>
</blockquote>
<p>上条第一段冒号下为：(一) 有与生产烟草专卖品相适应的资金。该段文字虽然是另起一行，但因为上段结束符号是冒号，本段开始前有(一)，因此，该段文字不视为是一个自然段，也不能认为其是一款。</p>
<h3 id="3-关于款的数目的书写。"><a href="#3-关于款的数目的书写。" class="headerlink" title="3. 关于款的数目的书写。"></a>3. 关于款的数目的书写。</h3><p>款的数目的书写一般应当使用中文，不用阿拉伯数字。如《烟草专卖法》第二条第二款，不写作《烟草专卖法》第二条第2款。</p>
<h3 id="4-款的适用"><a href="#4-款的适用" class="headerlink" title="4. 款的适用"></a>4. 款的适用</h3><p> 款一般可以独立适用，如《烟草专卖法》第二条第二款，但也有例外的，但与烟草专卖有关的法律法规中少见。</p>
<p>一个法条有两款或者两款以上的，应当适用到款。一个法条只有一款的，应当直接适用该法条，不应称作该条第一款，如：</p>
<blockquote>
<p>《条例》第三条烟草专卖品中的烟丝是指用烟叶、复烤烟叶、烟草薄片为原料加工制成的丝、末、粒状商品。</p>
</blockquote>
<p>在引用时，就应该写作“根据《实施条例》第三条”，而不是“根据《实施条例》第三条第一款”。</p>
<p>参照最高人民法院《关于引用法律、法令等所列条、款、项,目顺序的通知》，如果某一条下面没有分款而直接分列几项的，就不要加“第一款”，例如《条例》第七条只有（一）（二）（三）三项，就不要写“第七条第一款第一项”，而直接写“第七条第一项”。</p>
<h3 id="三、“项”"><a href="#三、“项”" class="headerlink" title="三、“项”"></a>三、“项”</h3><h3 id="1-项的概念"><a href="#1-项的概念" class="headerlink" title="1. 项的概念"></a>1. 项的概念</h3><p> 一般来讲，“项”是以列举的形式对前段文字的说明。如：</p>
<blockquote>
<p>《条例》第四十九条烟草专卖行政主管部门查处违反《烟草专卖法》和本条例的案件时，可以行使下列职权：</p>
<p>(一)询问违法案件的当事人、嫌疑人和证人；</p>
<p>(二)检查违法案件当事人的经营场所，依法对违法生产或者经营的烟草专卖品进行处理；</p>
<p>(三)查阅、复制与违法活动有关的合同、发票、账册、单据、记录、文件、业务函电和其他资料。</p>
</blockquote>
<p>​    该条的三个项是对前段文字中“下列职权”的列举式说明。</p>
<h3 id="2-项的表现形式"><a href="#2-项的表现形式" class="headerlink" title="2. 项的表现形式"></a>2. 项的表现形式</h3><p>含有项的法条，其前段文字中一般都有“下列”二字或相应的文字表述。“项”前冠以数字以对列举的内容进行排列。如《条例》四十九条，各项前都冠以(一)、(二)、(三)等数字，而且这些数字只能以中文数字加括号的形式出现。</p>
<h3 id="3-项的数目的书写"><a href="#3-项的数目的书写" class="headerlink" title="3. 项的数目的书写"></a>3. 项的数目的书写</h3><p>项的数目的书写一般应当使用中文加括号，不用阿拉伯数字。如《条例》第四十九条第（三）项，不写作《条例》第四十九条第3项。</p>
<h3 id="4-项的适用"><a href="#4-项的适用" class="headerlink" title="4. 项的适用"></a>4. 项的适用</h3><p>对含有项的法条，适用时应当适用到项；如对无证运输的处罚，应当适用《条例》第五十五条第(一)项。适用到项，是对被处罚的无证运输行为性质和情节的一种界定。如果不适用到项，该无证运输的行为就不知是四种行为之中的哪一种行为，有适用法律不准确之嫌。</p>
<p>根据立法技术的不同需要，“项”可以依附于条，也可以依附于款。即条中可以有项，款中也可以有项。</p>
<h3 id="四、“目”"><a href="#四、“目”" class="headerlink" title="四、“目”"></a>四、“目”</h3><h3 id="1-目的概念"><a href="#1-目的概念" class="headerlink" title="1. 目的概念"></a>1. 目的概念</h3><p> “目”隶属于项，是法律规范中最小的单位。“目”的特性与作用与“项”相似，不同的是项对条或款的列举式说明，而“目”是对项的列举式说明。如《条例》第五十五条第(二)项：</p>
<blockquote>
<p>(二)有下列情形之一的，没收违法运输的烟草专卖品和违法所得：</p>
<ol>
<li>非法运输的烟草专卖品价值超过5万元或者运输卷烟数量超过100件（每1万支为1件）的；</li>
<li>被烟草专卖行政主管部门处罚两次以上的；</li>
<li>抗拒烟草专卖行政主管部门的监督检查人员依法实施检查的；</li>
<li>非法运输走私烟草专卖品的；</li>
<li>运输无烟草专卖生产企业许可证的企业生产的烟草专卖品的；</li>
<li>利用伪装非法运输烟草专卖品的；</li>
<li>利用特种车辆运输烟草专卖品逃避检查的；</li>
<li>其他非法运输行为，情节严重的。</li>
</ol>
</blockquote>
<p>​    这八种情形，就是该项的八个目，列举没收违法运输的烟草专卖品和违法所得的八种情况。</p>
<h3 id="2-目的表现形式"><a href="#2-目的表现形式" class="headerlink" title="2. 目的表现形式"></a>2. 目的表现形式</h3><p>​    目的前面冠以阿拉伯数字，并在阿拉伯数字后加点(在具体引用法条的目时，只注明阿拉伯数字，无须加点)，例如《条例》第五十五条第(二)项第7目。</p>
<h3 id="3-目的适用"><a href="#3-目的适用" class="headerlink" title="3. 目的适用"></a>3. 目的适用</h3><p>如果某个法条或款的内容有“项”，而“项”下还有“目”的，在适用法律时就应当适用到“目”。如烟草专卖局在对非法运输走私烟草专卖品的行为进行处罚时，就应当适用《条例》第五十五条第(二)项第4目。当然，如果既非法运输走私烟草专卖品又利用特种车辆运输逃避检查，在作出处罚决定时就应同时适用相应的两个目。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/随笔/">随笔</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/13/2/" title="Invert a Binary Tree" itemprop="url">Invert a Binary Tree</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-13T05:01:00.000Z" itemprop="datePublished"> Published 2017-08-13</time>
    
  </p>
</header>
    <div class="article-content">
        
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">     4                          4</div><div class="line">   /    \                     /    \</div><div class="line">  2      7         to        7      2 </div><div class="line"> / \    /  \                / \    /  \</div><div class="line">1   3  6    9              9   6  3    1</div></pre></td></tr></table></figure>
<p>解答：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Definition for a binary tree node.</div><div class="line"> * strcut TreeNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     TreeNode *left;</div><div class="line"> *     TreeNode *right;</div><div class="line"> *     TreeNode (index x) : val(x), left(NULL), right(NULL) &#123;&#125;</div><div class="line"> * &#125;</div><div class="line"> */</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></div><div class="line">    <span class="keyword">public</span>:</div><div class="line">    <span class="function">TreeNode *<span class="title">invertTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (root == <span class="literal">NULL</span>)</div><div class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</div><div class="line">        TreeNoe * tmpNode = root-&gt;left;</div><div class="line">        root-&gt;left = invertTree(root-&gt;right);</div><div class="line">        root-&gt;right = invertTree(tmpNode);</div><div class="line">        <span class="keyword">return</span> root; </div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>利用的递归这个概念，短短几行就完成了一个翻转二叉树，只是在翻转二叉树的左右子数。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/C-C-算法/">C/C++,算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/13/1/" title="算法笔试入门题目Memmove" itemprop="url">算法笔试入门题目Memmove</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-13T04:02:10.000Z" itemprop="datePublished"> Published 2017-08-13</time>
    
  </p>
</header>
    <div class="article-content">
        
        <figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">memmove</span> <span class="params">(<span class="keyword">void</span> *dest, <span class="keyword">const</span> <span class="keyword">void</span> *src, <span class="keyword">size_t</span> n)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="comment">//implementation here</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这是 C 语言中的一个库函数，他的功能是吧内存中一块内容从src拷贝到dest，固定的长度是n。</p>
<p>这是笔试中的一个入门体</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">memmove</span> <span class="params">(<span class="keyword">void</span> *dest, <span class="keyword">const</span> <span class="keyword">void</span> *scr, <span class="keyword">size_t</span> n)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">char</span> *p1 = dest;</div><div class="line">	<span class="keyword">char</span> *p2 = src;</div><div class="line">	</div><div class="line">	<span class="keyword">while</span> (*p2 != \<span class="number">0</span>)</div><div class="line">		*p1++ = *p2++;</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> p1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的这份代码，可以完成要求，可是却存在一些问题，我们先来看一下，C语言中的一些让人进场不会注意到的陷阱。</p>
<ul>
<li>内存重叠的处理，从一个指针，它指向的内存地址，拷贝到另外一个地址，那么有没有可能是完全重合，或者有一部分是重合的。</li>
<li>临时变量太多 或者没有安全释放</li>
<li>没有测试内存越界，size 是否小于零，指针是否为空？</li>
<li>指针操作熟悉</li>
</ul>
<p>内存是否重叠？</p>
<p><img src="http://ogxeww23n.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-08-13%2014.45.22.png" alt="内存重叠">)</p>
<p>正确的写法</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">memmove</span> <span class="params">(<span class="keyword">void</span> *dest, <span class="keyword">const</span> <span class="keyword">void</span> *scr, <span class="keyword">size_t</span> n)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">char</span> *p1 = dest;</div><div class="line">	<span class="keyword">const</span> <span class="keyword">char</span> *p2 = src;		<span class="comment">//o用常量表示src</span></div><div class="line">	</div><div class="line">	<span class="comment">//判断src 和 dest 的位置关系</span></div><div class="line">	<span class="keyword">if</span>  (p2 &lt; p1) &#123; </div><div class="line">		p2 += n;</div><div class="line">		p1 += n;</div><div class="line">		<span class="keyword">while</span> (n-- != <span class="number">0</span>) </div><div class="line">			*--p1 = *--p2;</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</div><div class="line">			*p1++ = *p2++;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> p1;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/12/1/" title="Array&amp;String算法" itemprop="url">Array&amp;String算法</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-11T16:00:00.000Z" itemprop="datePublished"> Published 2017-08-12</time>
    
  </p>
</header>
    <div class="article-content">
        
        <figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Returns the position of the first occurrence of string target in string source or -1 if target is not part of source.</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">strStr</span> <span class="params">(String source, String target)</span> </span>&#123;</div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>希望在 <code>string</code> 里面寻找<code>target</code>，如果找到一个完全匹配的话，就返回他所在的位置，如果不存在就返回<code>-1</code>;</p>
<h1 id="字符串匹配"><a href="#字符串匹配" class="headerlink" title="字符串匹配"></a>字符串匹配</h1><p>两种比较容易实现的字符串比较算法。</p>
<p>假设在长度为 n的沐川中匹配长度为 m的子串。</p>
<p><code>Brute-Force</code> 算法： 顺序遍历母串，将每个字符作为匹配的起始字符，判断是否匹配子串。时间复杂度 O(m*n)</p>
<p><em>Brute-Force</em></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">char</span>* <span class="title">StrStr</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *str, <span class="keyword">const</span> <span class="keyword">char</span> *target)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(!*target) <span class="keyword">return</span> str;</div><div class="line">    <span class="keyword">char</span> *p1 = (<span class="keyword">char</span> *)str;</div><div class="line">    <span class="keyword">while</span>(*p1) &#123;</div><div class="line">        <span class="keyword">char</span> *p1Begin = p1, *p2 = (<span class="keyword">char</span>*)target;</div><div class="line">        <span class="keyword">while</span>(*p1 &amp;&amp; *p2 &amp;&amp; *p1 == *p2) &#123;</div><div class="line">            p1++;</div><div class="line">            p2++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!*p2)	<span class="comment">//发现p2走到了末尾，就意味着有匹配到的字符串，那么直接返回p1Begin;所记录的位置</span></div><div class="line">            <span class="keyword">return</span> p1Begin;</div><div class="line">        p1 = p1Begin + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/C-C/">C/C++</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/10/3/" title="Linux 和 GNU 工程" itemprop="url">Linux 和 GNU 工程</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-10T12:01:00.000Z" itemprop="datePublished"> Published 2017-08-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>每天都有许多计算机用户使用一个被改动过的GNU 系统 (18k 字节)，但是他们并没有意识到它。 经过一系列的事件，现在被广泛使用的 GNU 版本则经常被称作“Linux”，可是许多用户并不了解与之相关的 GNU 工程。</p>
<p>Linux 确实存在；它是一个内核，许多人都在使用它。但是你不能仅使用内核本身。内核只有作为整个系统的一个部分才有用处。Linux 是和 GNU 操作系统结合在一起使用：系统本身是 GNU，与 Linux 作为内核一起工作。</p>
<p>许多用户没有并不完全了解 Linux 内核和被称作“Linux”的整个系统的区别。而不加区别地使用这个名字并不能对理解有帮助。</p>
<p>程序员一般都知道 Linux 是一个内核。但是因为他们也听到整个系统被称作“Linux”，他们会根据名字去想象历史。比如，很多人认为当 Linus Torvalds 完成了内核后，他的朋友四处寻找其他的自由软件，而且所有的可以被组装成一个类似 Unix 系统的程序都是现成的。</p>
<p>他们的发现不是巧合 – 这就是 GNU 系统。 可用的自由软件加在一起就组成了一个完整的系统，这是由于自 1984 年就开始的 GNU 工程一直在为此努力。GNU 宣言(31k 字节) 早已设立了开发一个类似 Unix 的自由系统的目标，称作 GNU。GNU 工程的最初公告 也勾画了 GNU 系统的原始提纲。在 Linux 被编写时，这个系统几乎已经完成。</p>
<p>大多数自由软件的工程都是为了特定的工作开发特定的程序。比方说，Linus Torvalds 编写类似 Unix 的内核(Linux); Donald Knuth 编写一个文本格式化工具(TeX); Bob Scheifler 开发一个窗口系统(X Window System)。对于这项工程编写的程序都作出了贡献，对这些贡献进行评估是很自然的。</p>
<p>如果以这种方法来衡量对 GNU 工程的贡献，我们会得出什么结论？一个 CD-ROM的提供商发现在他们的“Linux 发行版”中，GNU 软件 占最大的比重，大约占全部源代码的 28% ，而且这还包括一些关键的部件，没有这些部件，系统就无法工作。Linux 本身占大约 3%。所以如果你要根据程序的作者来选择一个名字的话，最合适的选择是“GNU”。</p>
<p>但是我们不认为这是一个解决问题的适当方法。GNU 工程以前不是，现在也不是一个开发某个软件包的工程。它不是一个 开发 C 编译器的工程, 尽管我们做了。它也不是一个开发一个文本编辑器的工程，尽管我们也做了。GNU 工程的目标是开发一个完全自由的类似 Unix 的系统: GNU。</p>
<p>许多人已经为系统中的自由软件作出了重大贡献，他们都应该获得荣誉。但 GNU 是一个系统而不是一些实用程序的组合的原因是，GNU 工程的最初目标就是做一个完整系统。我们曾经为完成一个完整的系统做了一个所需程序清单，而且我们有系统地寻找，编写这些程序，并且寻找别人编写清单上的每一个程序。我们编写了关键的但是十分枯燥的主要部件，比如汇编语言和连接器，因为这是系统所必需的。除了编程工具，一个完整的系统还需要更多的东西， Bourne Again SHell 程序, PostScript 解释器 Ghostscript, 和 GNU C 库 同样是很重要的。</p>
<p>到了 90 年代初期，我们曾经把除了内核以外的东西放到一起组成了一个系统（我们同时也在做内核的工作）称为 GNU Hurd, 运行在 Mach 上)。开发这个内核比我们想象的要难得多，我们现在仍然在 为此工作。</p>
<p>庆幸的是，你不必再等了，因为 Linux 开发成功。当 Linus Torvalds 写成了 Linux，他填补了一个重要的空白。人们可以将 Linux 和 GNU 系统组成一个完整的自由系统：基于 Linux 的 GNU 系统（或简称为 GNU/Linux 系统）。</p>
<p>把它们组合到一起听起来很容易，但是这并不是一个简单的工作。 GNU C 库 (简称 glibc) 需要作大量的修改。集成到一个完整的发行系统中也是一项很大的工作。它需要对如何安装和启动系统进行定位 – 这个问题直到现在还在完善，因为我们还没有抓住要点。那些开发了不同的发行系统的人们作出了巨大贡献。</p>
<p>除了 GNU，还有一个独立进行的工程开发了一个自由的类似 Unix 的操作系统。这个系统被称为 BSD，它是由 UC Berkeley 开发的。 在 GNU 工程的鼓舞下，BSD 的开发者开始进行他们自己的自由软件的开发工作，并时常受到 GNU 人士的鼓励，但是他们的实际工作与 GNU 差别不大。今天 BSD 系统采用一些 GNU 软件，就象不同版本的 GNU 系统也采用 BSD 的软件一样。总的说来，它们是两套独立开发的不同的系统。今天一个免费的操作系统几乎都是采用 GNU 或 BSD 系统的一个派生版本。</p>
<p>GNU 工程支持 GNU/Linux 系统，就象支持 GNU 系统一样 – 包括资金的支持。我们为重写与 Linux 相关的 GNU C 库提供资金，以至于它们现在可以很好地集成在一起，直到最新版本的 GNU/Linux 仍在使用这个库而无需修改。我们也为早期 Debian GNU/Linux 的开发提供资金。</p>
<p>今天我们的绝大多数的工作都在基于 Linux 的 GNU 系统上完成，我们希望你也如此。但是请不要含糊地使用 Linux 而使公众迷惑。Linux 是内核，系统的关键部件之一。系统或多或少实际上都应该是 GNU 系统，再加上 Linux。当你在讨论到这个组合系统时，请使用 “GNU/Linux”。</p>
<p>如果要为 GNU/Linux 作链接，本页和 <a href="http://www.gnu.org/gnu/the-gnu-project.html" target="_blank" rel="noopener">http://www.gnu.org/gnu/the-gnu-project.html</a> 都是很好的选择。如果你想为 Linux（内核）作链接，<a href="http://www.kernel.org/是一个很好" target="_blank" rel="noopener">http://www.kernel.org/是一个很好</a> URL。</p>
<p>本文摘 <a href="https://www.gnu.org/gnu/linux-and-gnu.html" target="_blank" rel="noopener">https://www.gnu.org/gnu/linux-and-gnu.html</a></p>
<p>Copyright 1997, 1998 Richard Stallman</p>
<p>中文翻译：白若玉<br>翻译校正：刘昭宏</p>
<p>全文在保证完整性的前提下可以在任意媒体转载 - 须保留此标注。</p>
<p>Updated: 30 Nov 2000 paulv</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux-GNU/">Linux,GNU</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/10/2/" title="Virtualbox下安装 CentOS  minimal 后设置上网" itemprop="url">Virtualbox下安装 CentOS  minimal 后设置上网</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-10T08:04:12.000Z" itemprop="datePublished"> Published 2017-08-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>在虚拟机中以minimal安装 CentOS 后无法上网，因为CentOS的默认网卡未激活。</p>
<p>可以设置 </p>
<p>文件 /etc/sysconfig/network-scripts/ifcfg-enp0s3</p>
<p> 将 <code>ONBOOT=no</code> 改为 <code>ONBOOT=yes</code></p>
<p> <img src="http://www.maksim.website/images/linux/networkonboot.png" alt="激活"></p>
<p> 保存后重启网卡： <code>service network restart</code></p>
<p>  <img src="http://www.maksim.website/images/linux/ping.png" alt="ping"></p>
<p> 这样就可以上网了，我用的是桥接模式。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux-Centos/">Linux,Centos</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/10/1/" title="CentOS中Live、netinstall、minimal、DVD 等版本的区别" itemprop="url">CentOS中Live、netinstall、minimal、DVD 等版本的区别</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-10T07:04:12.000Z" itemprop="datePublished"> Published 2017-08-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><code>LiveCD</code> 和<code>LiveDVD</code> 是可以直接光盘运行的胸痛，但不能安装，两者差别在于容量大小，DVD 包含的软件要多一些。</p>
<p><code>netinstall</code> 用于网络安装和系统救援的镜像文件。</p>
<p><code>minimal</code> 这个镜像文件用于安装一个非常基本的 CentOS系统,包含了一些基本所需的最小安装包。</p>
<p><code>DVD</code> 镜像包含了完整的发布版，可以用于安装完整的 CentOS 系统。</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Linux/">Linux</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Linux-Centos/">Linux,Centos</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/05/1/" title="在Mac上编译安装线程安全的PHP7.2" itemprop="url">在Mac上编译安装线程安全的PHP7.2</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Maksim" target="_blank" itemprop="author">Maksim</a>
		
  <p class="article-time">
    <time datetime="2017-08-05T04:04:12.000Z" itemprop="datePublished"> Published 2017-08-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>因为项目需求后期可能会需要使用到进程守护和消息队列，于是上网查了一下，看到<a href="http://netkiller.github.io/php/index.html" target="_blank" rel="noopener">Netkiller <em>PHP 手札</em></a>中有介绍到PHP使用 Pthread实现优雅守护进程的方法。</p>
<p>可是由于我本地的 PHP 是使用brew进行安装的，在 Linux 下使用 yum或者 apt进行安装的 PHP 同样不支持线程安全。</p>
<p>于是开始折腾起来，将 PHP 卸载掉后使用编译进行重新安装，开启<code>--enable-maintainer-zts</code> 后在编译过程中遇到了 Clang 报错，经过了一番 Google、百度过后，原来是编译器在作怪。Mac 由于 Xcode 的原因，默认使用的编译器是 Clang，在编译到 pthread 的时候，就会报错。</p>
<p>解决方法也很简单，在./configure 命令的最后加上 CC=gcc ，告诉make 我要使用 GCC 编译器进行编译即可。</p>
<p>其实在日常的开发中PHP开发者，很少会接触到多线程这一块。甚至有的PHP 开发者都搞不清楚什么是线程、进程和协程。</p>
<p>那是因为在 Web 开发中根本使用不了多线程，因为 PHP 本身并不提供多线程API，其多线程的支持是由 Pthread 扩展提供的，而 Pthread 扩展的文档中有说明：</p>
<blockquote>
<p><strong>Warning</strong>    不可以在 web 服务器环境中使用 pthreads 扩展，PHP 多线程开发仅限于命令行模式的应用。</p>
</blockquote>
<p>Windows版的PHP从版本5.2.1开始有Thread Safe(线程安全)和None Thread Safe(NTS，非线程安全)之分，这两者不同在于何处？到底应该用哪种？</p>
<p>从2000年 10月20日发布的第一个Windows版的PHP3.0.17开始的都是线程安全的版本，这是由于与Linux/Unix系统是采用多进程的工作方式不同的导致的。</p>
<p>Windows系统是采用多线程的工作方式。如果在IIS下以CGI方式运行PHP会非常慢，这是由于CGI模式是建立在多进程的基础之上的，而非多线程。一般我们会把PHP配置成以ISAPI的方式来运行，ISAPI是多线程的方式，这样就快多了。</p>
<p>但存在一个问题，很多常用的PHP扩展是以 Linux/Unix的多进程思想来开发的，这些扩展在ISAPI的方式运行时就会出错搞垮IIS。因此在IIS下CGI模式才是PHP运行的最安全方式，但CGI模式对于每个HTTP请求都需要重新加载和卸载整个PHP环境，其消耗是巨大的。</p>
<p>为了兼顾IIS下PHP的效率和安全，微软 给出了FastCGI的解决方案。FastCGI可以让PHP的进程重复利用而不是每一个新的请求就重开一个进程。同时FastCGI也可以允许几个进程同时执行。这样既解决了CGI进程模式消耗太大的问题，又利用上了CGI进程模式不存在线程安全问题的优势。</p>
<p>因此，如果是使用ISAPI 的方式来运行PHP就必须用Thread Safe(线程安全)的版本；而用FastCGI模式运行PHP的话就没有必要用线程安全检查了，用None Thread Safe(NTS，非线程安全)的版本能够更好的提高效率。</p>
<p>从上面这段描述我们可以清楚的知道，如果不是使用 ISAPI 的话，不使用多线程特性，那么基本上就用不Thread Safe。</p>
<p>查看自己的 PHP版本是否是线程安全你的只需要在命令行中输入 <code>PHP -v</code>查看 PHP 的版本即可，如下：</p>
<p><img src="http://www.maksim.website/images/threadsafe.png" alt="线程安全"></p>
<p>引用：</p>
<p><em>PHP线程安全和非线程安全有什么区别</em>  <a href="http://www.cnblogs.com/T8881/p/6397264.html" target="_blank" rel="noopener">http://www.cnblogs.com/T8881/p/6397264.html</a></p>
<p><em>PHP Internals Book（《PHP内部书》PHP 内核开发者合著)</em> <a href="http://www.phpinternalsbook.com/index.html" target="_blank" rel="noopener">http://www.phpinternalsbook.com/index.html</a></p>
<p><em>PHP运行模式</em> <a href="http://www.cnblogs.com/xia520pi/p/3914964.html" target="_blank" rel="noopener">http://www.cnblogs.com/xia520pi/p/3914964.html</a></p>
<p><em>Netkiller <em>PHP 手札</em></em> <a href="http://netkiller.github.io/php/index.html" target="_blank" rel="noopener">http://netkiller.github.io/php/index.html</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/PHP/">PHP</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/多线程-PHP7-2-编译安装-GCC/">多线程,PHP7.2,编译安装,GCC</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/4/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/6/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/C-C/" title="C/C++">C/C++<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaScript/" title="JavaScript">JavaScript<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/MySQL/" title="MySQL">MySQL<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/Objective-C/" title="Objective-C">Objective-C<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/PHP/" title="PHP">PHP<sup>20</sup></a></li>
		  
		
		  
			<li><a href="/categories/iOS/" title="iOS">iOS<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/ios/" title="ios">ios<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/javascript/" title="javascript">javascript<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/工具/" title="工具">工具<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/设计/" title="设计">设计<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/读书笔记/" title="读书笔记">读书笔记<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/随笔/" title="随笔">随笔<sup>4</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/iOS/" title="iOS">iOS<sup>14</sup></a></li>
			
		
			
				<li><a href="/tags/随笔/" title="随笔">随笔<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/MySQL/" title="MySQL">MySQL<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/PHP/" title="PHP">PHP<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/设计模式/" title="设计模式">设计模式<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Linux-Centos/" title="Linux,Centos">Linux,Centos<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/PHP基础/" title="PHP基础">PHP基础<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Linux-GNU/" title="Linux,GNU">Linux,GNU<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/服务容器/" title="服务容器">服务容器<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Closures/" title="Closures">Closures<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/php/" title="php">php<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C-C-算法/" title="C/C++,算法">C/C++,算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Objc-多线程/" title="Objc,多线程">Objc,多线程<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/INSERT/" title="INSERT">INSERT<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/wechat-pay-php-php7-php-input/" title="wechat pay, php, php7, php://input">wechat pay, php, php7, php://input<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/工具/" title="工具">工具<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/多线程-PHP7-2-编译安装-GCC/" title="多线程,PHP7.2,编译安装,GCC">多线程,PHP7.2,编译安装,GCC<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/内存管理/" title="内存管理">内存管理<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/面试/" title="面试">面试<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=null&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="Maksim">Maksim</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>












<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
