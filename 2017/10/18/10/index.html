<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>《PHP internals Book》 介绍 | Maksim&#39;s Website</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="介绍这本书是几个PHP开发人员之间的协作努力，可以更好地记录和描述PHP内部的工作原理。 这本书有三个主要目标：   记录和描述PHP内部工作原理。 记录并描述如何使用扩展扩展语言。 记录并描述如何与社区进行交互以开发PHP本身。   本书主要面向具有C编程语言经验的开发人员。然而，尽管如此，我们将尝试提炼信息并对其进行总结，以便不了解C的开发人员仍然能够理解内容。 但是，让我们坚持。如果您不知道">
<meta property="og:type" content="article">
<meta property="og:title" content="《PHP internals Book》 介绍">
<meta property="og:url" content="http://www.maksim.website/2017/10/18/10/index.html">
<meta property="og:site_name" content="Maksim&#39;s Website">
<meta property="og:description" content="介绍这本书是几个PHP开发人员之间的协作努力，可以更好地记录和描述PHP内部的工作原理。 这本书有三个主要目标：   记录和描述PHP内部工作原理。 记录并描述如何使用扩展扩展语言。 记录并描述如何与社区进行交互以开发PHP本身。   本书主要面向具有C编程语言经验的开发人员。然而，尽管如此，我们将尝试提炼信息并对其进行总结，以便不了解C的开发人员仍然能够理解内容。 但是，让我们坚持。如果您不知道">
<meta property="og:updated_time" content="2017-10-18T13:45:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="《PHP internals Book》 介绍">
<meta name="twitter:description" content="介绍这本书是几个PHP开发人员之间的协作努力，可以更好地记录和描述PHP内部的工作原理。 这本书有三个主要目标：   记录和描述PHP内部工作原理。 记录并描述如何使用扩展扩展语言。 记录并描述如何与社区进行交互以开发PHP本身。   本书主要面向具有C编程语言经验的开发人员。然而，尽管如此，我们将尝试提炼信息并对其进行总结，以便不了解C的开发人员仍然能够理解内容。 但是，让我们坚持。如果您不知道">
    
        <link rel="alternate" type="application/atom+xml" title="Maksim&#39;s Website" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Maksim</h5>
          <a href="mailto:aircrayon@qq.com" title="aircrayon@qq.com" class="mail">aircrayon@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/aircrayon" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/619946234" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-link"></i>
                关于Maksim
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">《PHP internals Book》 介绍</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">《PHP internals Book》 介绍</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-10-17T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2017-10-18
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/PHP/">PHP</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#介绍"><span class="post-toc-number">1.</span> <span class="post-toc-text">介绍</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#使用PHP构建系统"><span class="post-toc-number">2.</span> <span class="post-toc-text">使用PHP构建系统</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#构建"><span class="post-toc-number">3.</span> <span class="post-toc-text">构建</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#为什么不使用包？"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">为什么不使用包？</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#获取源代码"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">获取源代码</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#构建概述"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">构建概述</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#buildconf脚本"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">./buildconf脚本</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#configure脚本"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">./configure脚本</span></a></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-《PHP-internals-Book》-介绍"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">《PHP internals Book》 介绍</h1>
        <div class="post-meta">
            <time class="post-time" title="2017-10-18 00:00:00" datetime="2017-10-17T16:00:00.000Z"  itemprop="datePublished">2017-10-18</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/PHP/">PHP</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>这本书是几个PHP开发人员之间的协作努力，可以更好地记录和描述PHP内部的工作原理。</p>
<p>这本书有三个主要目标：</p>
<blockquote>
<ul>
<li>记录和描述PHP内部工作原理。</li>
<li>记录并描述如何使用扩展扩展语言。</li>
<li>记录并描述如何与社区进行交互以开发PHP本身。</li>
</ul>
</blockquote>
<p>本书主要面向具有C编程语言经验的开发人员。然而，尽管如此，我们将尝试提炼信息并对其进行总结，以便不了解C的开发人员仍然能够理解内容。</p>
<p>但是，让我们坚持。如果您不知道C语言，您将无法实现高效，稳定（任何平台下的崩溃），性能和实用性。以下是有关C语言本身，生态系统和构建工具以及操作系统API的一些非常好的在线资源：</p>
<ul>
<li><a href="http://www.tenouk.com/" target="_blank" rel="external">http://www.tenouk.com/</a></li>
<li><a href="https://en.wikibooks.org/wiki/C_Programming" target="_blank" rel="external">https://en.wikibooks.org/wiki/C_Programming</a></li>
<li><a href="http://c-faq.com/" target="_blank" rel="external">http://c-faq.com/</a></li>
<li><a href="https://www.gnu.org/software/libc/" target="_blank" rel="external">https://www.gnu.org/software/libc/</a></li>
<li><a href="http://www.faqs.org/docs/Linux-HOWTO/Program-Library-HOWTO.html" target="_blank" rel="external">http://www.faqs.org/docs/Linux-HOWTO/Program-Library-HOWTO.html</a></li>
<li><a href="http://www.iecc.com/linker/linker10.html" target="_blank" rel="external">http://www.iecc.com/linker/linker10.html</a></li>
</ul>
<p>我们还高度推荐你一些书。您将与他们一起学习如何有效地使用C语言，以及如何使其转化为高效的CPU指令，以便您可以设计强/快/可靠和安全的程序。</p>
<ul>
<li>The C Programming Language (Ritchie &amp; Kernighan)</li>
<li>Advanced Topics in C Core Concepts in Data Structures</li>
<li>Learn C the Hard Way</li>
<li>The Art of Debugging with GDB DDD and Eclipse</li>
<li>The Linux Programming Interface</li>
<li>Advanced Linux Programming</li>
<li>Hackers Delight</li>
<li>Write Great Code (2 Volumes)</li>
</ul>
<blockquote>
<p>注意</p>
<p>这本书是正在进行中的，还有一些章节还没有写（特别是关于创建基本扩展和声明函数的章节），所以如果你是PHP扩展开发的全新功能，你必须等到剩下的介绍性章节已经出版或开始与其他 <a href="https://wiki.php.net/internals/references" target="_blank" rel="external">资源相关的话题</a>。</p>
</blockquote>
<p>本书的存储库可在<a href="https://github.com/phpinternalsbook/PHP-Internals-Book" target="_blank" rel="external">GitHub</a>上<a href="https://github.com/phpinternalsbook/PHP-Internals-Book" target="_blank" rel="external">找到</a>。请报告问题并提供有关<a href="https://github.com/phpinternalsbook/PHP-Internals-Book/issues" target="_blank" rel="external">问题跟踪的</a>反馈。</p>
<h1 id="使用PHP构建系统"><a href="#使用PHP构建系统" class="headerlink" title="使用PHP构建系统"></a>使用PHP构建系统</h1><p>在本章中，我们将介绍如何使用PHP构建系统来编译本身和其他扩展。本章不会关心编写自己的autoconf构建指令，仅解释如何使用该工具。</p>
<p>内容：</p>
<ul>
<li>构建PHP<ul>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#why-not-use-packages" target="_blank" rel="external">为什么不使用包？</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#obtaining-the-source-code" target="_blank" rel="external">获取源代码</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#build-overview" target="_blank" rel="external">构建概述</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#the-buildconf-script" target="_blank" rel="external"><code>./buildconf</code>脚本</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#the-configure-script" target="_blank" rel="external"><code>./configure</code>脚本</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#make-and-make-install" target="_blank" rel="external"><code>make</code>和<code>make install</code></a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#running-the-test-suite" target="_blank" rel="external">运行测试套件</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#fixing-compilation-problems-and-make-clean" target="_blank" rel="external">修复编译问题和<code>make clean</code></a></li>
</ul>
</li>
<li>构建PHP扩展<ul>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_extensions.html#loading-shared-extensions" target="_blank" rel="external">加载共享扩展</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_extensions.html#installing-extensions-from-pecl" target="_blank" rel="external">从PECL安装扩展</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_extensions.html#adding-extensions-to-the-php-source-tree" target="_blank" rel="external">添加PHP源代码树的扩展</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_extensions.html#building-extensions-using-phpize" target="_blank" rel="external">使用<code>phpize</code>构建扩展</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_extensions.html#displaying-information-about-extensions" target="_blank" rel="external">显示有关扩展的信息</a></li>
<li><a href="http://www.phpinternalsbook.com/php7/build_system/building_extensions.html#extensions-api-compatibility" target="_blank" rel="external">扩展API兼容性</a></li>
</ul>
</li>
</ul>
<h1 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h1><p>本章介绍如何以适合开发扩展或核心修改的方式编译PHP。我们将仅覆盖Unixoid系统上的构建。如果您希望在Windows上构建PHP，那么您应该看看PHP wiki中的<a href="https://wiki.php.net/internals/windows/stepbystepbuild" target="_blank" rel="external">分步构建指令</a><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#id4" target="_blank" rel="external">[1]</a>。</p>
<p>本章还概述了PHP构建系统的工作原理及其使用的工具，但详细描述不在本书的范围之内。</p>
<blockquote>
<p><a href="http://www.phpinternalsbook.com/php7/build_system/building_php.html#id2" target="_blank" rel="external">[1]</a> 免责声明：我们对于在Windows上编译PHP所造成的不良健康影响不承担责任。</p>
</blockquote>
<h2 id="为什么不使用包？"><a href="#为什么不使用包？" class="headerlink" title="为什么不使用包？"></a>为什么不使用包？</h2><p>如果您正在使用PHP，则可能通过包管理器安装它，使用像<code>sudo apt-get install php</code>这样的 <code>命令</code>。在解释实际编译之前，您应该首先了解为什么要自己编译是必要的，而不能仅仅使用预构建的包。有以下几个原因：</p>
<p>首先，预构建的包只包含所生成的二进制文件，但是错过了编译扩展所需的其他东西，例如头文件。这可以通过安装开发包（通常称为<code>php-dev</code>）来轻松解决。为了方便使用valgrind或gdb进行调试，可以另外安装调试符号，通常可以使用另一个名为<code>php-dbg</code>的包。</p>
<p>但是即使您安装了头文件和调试符号，仍然会使用PHP的发布版本。这意味着它将以高优化级别构建，这可以使调试变得非常困难。此外，release builds不会产生有关内存泄漏或数据结构不一致的警告。另外，预先构建的软件包不能实现线程安全性，这在开发过程中非常有用。</p>
<p>另一个问题是几乎所有的发行版都向PHP应用了补丁。在某些情况下，这些修补程序仅包含与配置相关的微小更改，但某些发行版使用高度侵入式的修补程序（如Suhosin）。已知有些补丁引入与低级别扩展（如opcache）的不兼容性。</p>
<p>PHP仅支持<a href="http://www.php.net/" target="_blank" rel="external">php.net</a>上提供的软件，而不是分发版本的软件。如果您想报告错误，提交补丁或使用我们的帮助渠道进行扩展写作，那么您应该始终使用官方PHP版本。当我们在这本书中谈到“PHP”时，我们一直指的是官方支持的版本。</p>
<h2 id="获取源代码"><a href="#获取源代码" class="headerlink" title="获取源代码"></a>获取源代码</h2><p>在构建PHP之前，首先需要获取源代码。有两种方法可以执行此操作：您可以从<a href="http://www.php.net/downloads.php" target="_blank" rel="external">PHP的下载页面</a>下载存档，也可以从<a href="http://git.php.net/" target="_blank" rel="external">git.php.net</a>（或<a href="http://www.github.com/php/php-src" target="_blank" rel="external">Github</a>上的镜像 ）克隆Git存储库。</p>
<p>对于这两种情况，构建过程略有不同：git存储库不捆绑<code>配置</code>脚本，因此您需要使用<code>buildconf</code>脚本生成它，这使用了autoconf。此外，git存储库不包含预生成的解析器，因此您还需要安装bison。</p>
<p>我们建议您从git中检出源代码，因为这将为您提供一种简单的方式来更新安装，并尝试使用不同版本的代码。如果要提交补丁或提取PHP请求，还需要git结帐。</p>
<p>要克隆存储库，请在您的shell中运行以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">〜&gt; git clone http://git.php.net/repository/php-src.git</div><div class="line">〜&gt; cd php-src</div><div class="line"> ＃默认情况下你将在主分支上，这是当前的</div><div class="line">＃开发版本。你可以检查一个稳定的分支：</div><div class="line">〜/ php-src&gt; git checkout PHP-7.0</div></pre></td></tr></table></figure>
<p>如果您有git结帐的问题，请查看PHP wiki上的<a href="https://wiki.php.net/vcs/gitfaq" target="_blank" rel="external">Git常见问题</a>。Git常见问题解答还介绍了如何设置git，如果你想贡献给PHP本身。此外，它还包含有关为不同PHP版本设置多个工作目录的说明。如果您需要根据多个PHP版本和配置测试扩展或更改，这可能非常有用。</p>
<p>在继续之前，您还应该与包管理器一起安装一些基本构建依赖项（默认情况下，您可能已经安装了前三个）：</p>
<ul>
<li><code>gcc</code>或其他一些编译器套件。</li>
<li><code>libc-dev</code>，它提供了C标准库，包括头文件。</li>
<li><code>make</code>，这是PHP使用的构建管理工具。</li>
<li><code>autoconf</code>（2.59或更高版本），用于生成<code>配置</code>脚本。</li>
<li><code>automake</code>（1.4或更高），它生成<code>Makefile.in</code>文件。</li>
<li><code>libtool</code>帮助管理共享库。</li>
<li><code>bison</code>（2.4或更高版本），用于生成PHP解析器。</li>
<li>（可选）<code>re2c</code>，用于生成PHP词法分析器。由于git存储库已经包含生成的词法分析器，所以只需要对其进行更改即可。</li>
</ul>
<p>在Debian / Ubuntu上，您可以使用以下命令安装所有这些：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">〜/ php-src&gt; sudo apt-get install build-essential autoconf automake libtool bison re2c</div></pre></td></tr></table></figure>
<p>根据在<code>./configure</code>阶段启用的扩展，PHP将需要一些额外的库。安装它们时，请检查是否存在以<code>-dev</code>或<code>-devel</code>结尾的软件包版本，并安装它们。没有<code>开发</code>的软件包通常不包含必需的头文件。例如，默认的PHP构建将需要libxml，您可以通过<code>libxml2-dev</code>软件包进行安装。</p>
<p>如果您使用的是Debian或Ubuntu，您可以使用<code>sudo apt-get build-dep php7</code>一次性安装大量可选构建依赖项。如果你只是针对默认构建，那么很多都是没有必要的。</p>
<h2 id="构建概述"><a href="#构建概述" class="headerlink" title="构建概述"></a>构建概述</h2><p>在仔细观察单个构建步骤之前，下面是为“默认”PHP构建执行的命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">〜/ php-src&gt; ./buildconf ＃只有从git构建才需要</div><div class="line">〜/ php-src&gt; ./configure</div><div class="line">〜/ php-src&gt; make -jN</div></pre></td></tr></table></figure>
<p>对于快速构建，请将<code>N</code>替换为可用的CPU内核数（请参阅<code>grep “cpu cores” / proc / cpuinfo</code>）。</p>
<p>默认情况下，PHP将为CLI和CGI SAPI建立二进制文件，分别位于<code>sapi / cli / php</code>和 <code>sapi / cgi / php-cgi</code>。检查一切顺利，尝试运行<code>sapi / cli / php -v</code>。</p>
<p>此外，您可以运行<code>sudo make install</code>将PHP安装到<code>/usr/local</code>中。可以通过在配置阶段指定<code>--prefix</code>来更改目标目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">〜/ php-src&gt; ./configure --prefix = $ HOME / myphp</div><div class="line">〜/ php-src&gt; make -jN</div><div class="line">〜/ php-src&gt; make install</div></pre></td></tr></table></figure>
<p>这里<code>$HOME/myphp</code>是将在过程中使用的安装位置<code>make install</code>步骤。请注意，安装PHP不是必需的，但如果要在扩展开发之外使用PHP构建，可以方便。</p>
<p>现在让我们仔细看看个别的构建步骤！</p>
<h2 id="buildconf脚本"><a href="#buildconf脚本" class="headerlink" title="./buildconf脚本"></a><code>./buildconf</code>脚本</h2><p>如果您正在从git存储库中构建，您首先要执行的操作是运行<code>./buildconf</code>脚本。这个脚本只是调用<code>build / build.mk</code> makefile，而makefile又调用<code>build / build2.mk</code>。</p>
<p>这些makefile的主要工作是运行<code>的autoconf</code>生成<code>的./configure</code>脚本<code>和autoheader</code>生成<code>主/ php_config.h.in</code>模板。后一个文件将被configure用于生成最终配置头文件<code>main / php_config.h</code>。</p>
<p>这两个实用程序都从<code>configure.in</code>文件（它指定了大多数PHP构建过程），<code>acinclude.m4</code>文件（指定大量PHP特定的M4宏）和各个扩展名的<code>config.m4</code>文件生成其结果， SAPI（以及一堆其他<code>m4</code>文件）。</p>
<p>好消息是，编写扩展或甚至进行核心修改不需要与构建系统进行很多交互。您稍后必须编写小型<code>config.m4</code>文件，但通常只需使用<code>acinclude.m4</code>提供的两个或三个高级宏。因此，我们将不再详细说明。</p>
<p>该<code>./buildconf即可</code>剧本只有两个选项：<code>--debug</code>调用autoconf和autoheader就何时禁用警告抑制。除非你想在构建系统上工作，否则这个选项对你没有什么兴趣。</p>
<p>第二个选项是<code>--force</code>，它将允许在发行包中运行<code>./buildconf</code>（例如，如果您下载了打包的源代码并希望生成新的<code>./configure</code>），并且另外清除配置缓存 <code>config.cache</code>和<code>autom4te.cache /</code>。</p>
<p>如果您使用<code>git pull</code>（或其他一些命令）更新git仓库，并在<code>make</code> 步骤中获得奇怪的错误，这通常意味着构建配置中的某些内容发生变化，您需要运行<code>./buildconf --force</code>。</p>
<h2 id="configure脚本"><a href="#configure脚本" class="headerlink" title="./configure脚本"></a><code>./configure</code>脚本</h2><p>一旦生成了<code>./configure</code>脚本，您可以利用它来自定义您的PHP构建。您可以使用<code>--help</code>列出所有支持的选项：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">〜/ php-src&gt; ./configure --help | 减</div></pre></td></tr></table></figure>
<p>帮助的第一部分将列出各种通用选项，这些选项由所有基于autoconf的配置脚本支持。其中一个是已经提到的<code>--prefix = DIR</code>，它改变了<code>make install</code>使用的安装目录 。另一个有用的选项是<code>-C</code>，它将缓存<code>config.cache</code> 文件中的各种测试结果，并加快后续的<code>./configure</code>调用。一旦你已经有一个工作的构建，并希望在不同的配置之间快速的改变，使用这个选项才有意义。</p>
<p>通用的autoconf选项除了特定于PHP的许多设置外，例如，您可以选择使用<code>--enable-NAME</code>和<code>--disable-NAME</code>开关来编译哪些扩展和SAPI 。如果扩展或SAPI具有外部依赖关系，则需要使用<code>--with-NAME</code>和<code>--without-NAME</code>。如果<code>NAME</code>所需的库 不在默认位置（例如，因为您自己编译），则可以使用<code>--with-NAME = DIR</code>指定其位置。</p>
<p>默认情况下，PHP将构建CLI和CGI SAPI，以及一些扩展。您可以使用<code>-m</code>选项找出PHP二进制包含哪些扩展名。对于默认的PHP 7.0构建，结果将如下所示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">~/php-src&gt; sapi/cli/php -m</div><div class="line">[PHP Modules]</div><div class="line">Core</div><div class="line">ctype</div><div class="line">date</div><div class="line">dom</div><div class="line">fileinfo</div><div class="line">filter</div><div class="line">hash</div><div class="line">iconv</div><div class="line">json</div><div class="line">libxml</div><div class="line">pcre</div><div class="line">PDO</div><div class="line">pdo_sqlite</div><div class="line">Phar</div><div class="line">posix</div><div class="line">Reflection</div><div class="line">session</div><div class="line">SimpleXML</div><div class="line">SPL</div><div class="line">sqlite3</div><div class="line">standard</div><div class="line">tokenizer</div><div class="line">xml</div><div class="line">xmlreader</div><div class="line">xmlwriter</div></pre></td></tr></table></figure>
<p>如果现在想停止编译CGI SAPI，以及tokenizer和sqlite3扩展，而是启用opcache和gmp，相应的configure命令将是：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">〜/ php-src&gt; ./configure --disable-cgi --disable-tokenizer --without-sqlite3 \</div><div class="line">                       --enable-opcache --with-gmp</div></pre></td></tr></table></figure>
<p>默认情况下，大多数扩展将被静态编译，即它们将成为生成的二进制文件的一部分。默认情况下只有opcache扩展名是共享的，即它将在<code>modules /</code>目录中生成一个<code>opcache.so</code>共享对象。您可以通过编写<code>--enable-NAME = shared</code>或<code>--with-NAME = shared</code> （但不是所有的扩展都支持此）来编译其他扩展到共享对象。我们将在下一节中讨论如何使用共享扩展。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">要找出需要使用哪个交换机，以及默认情况下是否启用扩展，请检查`./configure --help`。如果交换机是`--enable-NAME`或`--with-NAME，`则表示该扩展未被默认编译，需要显式启用。`--disable-NAME`或`--without-NAME`表示默认编译的扩展名，但可以被明确禁用。</div><div class="line"></div><div class="line">一些扩展总是被编译，不能禁用。要创建只包含最小数量的扩展名的构建，请使用`--disable-all`选项：</div></pre></td></tr></table></figure></p>
<p>〜/ php-src&gt; ./configure –disable-all &amp;&amp; make -jN<br>〜/ php-src&gt; sapi/cli/php -m<br>[PHP Modules]<br>Core<br>date<br>pcre<br>Reflection<br>SPL<br>standard<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">本`-禁用所有`，如果你想快速构建，并不需要太多的功能（例如实现语言的变化时）选项是非常有用的。对于最小的构建，您可以另外指定`--disable-cgi` 开关，因此只生成CLI二进制文件。</div><div class="line"></div><div class="line">还有两个开关，您应该**始终**在开发扩展或PHP工作时指定：</div><div class="line"></div><div class="line">`--enable-debug`启用调试模式，具有多重效果：编译将使用` -g`运行，以生成调试符号，另外使用最低优化级别` -O0`。这将使PHP慢得多，但使用像` gdb`这样的工具进行调试更加可预测。此外，调试模式定义了` ZEND_DEBUG`宏，它将启用引擎中的各种调试助手。将会报告内存泄漏以及某些数据结构的不正确使用。</div><div class="line"></div><div class="line">`--enable-maintainer-zts`可以实现线程安全。该开关将定义` ZTS`宏，这又将使得PHP使用的整个TSRM（线程安全资源管理器）机器。为PHP编写线程安全扩展非常简单，但只有确保启用此开关。</div><div class="line"></div><div class="line">另一方面，如果您要为代码执行性能基准测试，则不能使用这些选项，因为这两个选项都可能导致显着的和不对称的减速。</div><div class="line"></div><div class="line">请注意，-- `enable-debug`和`--enable-maintainer-zts可以`更改PHP二进制文件的ABI，例如通过向许多函数添加其他参数。由于这种在调试模式下编译的共享扩展将不兼容内置在发行模式下的PHP二进制文件。类似地，线程安全扩展与线程不安全的PHP构建不兼容。</div><div class="line"></div><div class="line">由于ABI不兼容`使 安装`（和PECL安装）将投入取决于这些选项不同的目录共享扩展：</div><div class="line"></div><div class="line">- `$ PREFIX / lib / php / extensions / no-debug-non-zts-API_NO`用于没有ZTS的发行版</div><div class="line">- `$ PREFIX / lib / php / extensions / debug-non-zts-API_NO`用于没有ZTS的调试版本</div><div class="line">- `$ PREFIX / lib / php / extensions / no-debug-zts-API_NO`用于使用ZTS发布版本</div><div class="line">- `$ PREFIX / lib / php / extensions / debug-zts-API_NO`用于使用ZTS调试版本</div><div class="line"></div><div class="line">上面的`API_NO`占位符是指`ZEND_MODULE_API_NO`，只是像`20100525`这样的日期，用于内部API版本控制。</div><div class="line"></div><div class="line">对于大多数目的，上述配置开关应该是足够的，但当然`./configure` 提供了更多的选项，您将在帮助中找到它们。</div><div class="line"></div><div class="line">除了传递配置选项之外，还可以指定一些环境变量。在配置帮助输出（`./configure --help | tail -25`）的末尾记录了一些更重要的信息。</div><div class="line"></div><div class="line">例如，您可以使用`CC`使用不同的编译器和`CFLAGS`来更改使用的编译标志：</div></pre></td></tr></table></figure></p>
<p>〜/ php-src&gt; ./configure –disable-all CC = clang CFLAGS = “-O3 -march = native”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">在此配置中，构建将使用clang（而不是gcc），并使用非常高的优化级别（`-O3 -march = native`）。</div><div class="line"></div><div class="line">您可以使用附加的编译器警告标志来帮助您发现一些错误。对于GCC，您可以[在GCC手册中](https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options)阅读</div><div class="line"></div><div class="line">## `make`和`make install`</div><div class="line"></div><div class="line">配置完所有内容后，可以使用`make`来执行实际的编译：</div></pre></td></tr></table></figure>
<p>〜/ php-src&gt; make -jN     ＃其中N是核心数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">此操作的主要结果将是启用的SAPI（默认为`sapi / cli / php`和 `sapi / cgi / php-cgi`）的PHP二进制文件以及`modules /`目录中的共享扩展。</div><div class="line"></div><div class="line">现在，您可以运行`make install`将PHP安装到`/usr/local`（默认）或使用`--prefix` configure开关指定的任何目录。</div><div class="line"></div><div class="line">`make install`只会将一些文件复制到新的位置。除非您在配置过程中指定 `--without-pear`，否则也会下载并安装PEAR。以下是默认PHP构建的结果树：</div></pre></td></tr></table></figure></p>
<blockquote>
<p>tree -L 3 -F ~/myphp</p>
</blockquote>
<p>/home/myuser/myphp<br>|– bin<br>|   |– pear<em><br>|   |– peardev</em><br>|   |– pecl<em><br>|   |– phar -&gt; /home/myuser/myphp/bin/phar.phar</em><br>|   |– phar.phar<em><br>|   |– php</em><br>|   |– php-cgi<em><br>|   |– php-config</em><br>|   <code>-- phpize*
|-- etc
|</code>– pear.conf<br>|– include<br>|   <code>-- php
|       |-- ext/
|       |-- include/
|       |-- main/
|       |-- sapi/
|       |-- TSRM/
|</code>– Zend/<br>|– lib<br>|   <code>-- php
|       |-- Archive/
|       |-- build/
|       |-- Console/
|       |-- data/
|       |-- doc/
|       |-- OS/
|       |-- PEAR/
|       |-- PEAR5.php
|       |-- pearcmd.php
|       |-- PEAR.php
|       |-- peclcmd.php
|       |-- Structures/
|       |-- System.php
|       |-- test/
|</code>– XML/<br><code>-- php</code>– man<br>        `– man1/<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">目录结构的简要概述：</div><div class="line"></div><div class="line">- *bin /*包含SAPI二进制文件（`php`和`php-cgi`），以及`phpize`和`php-config`脚本。它也是各种PEAR / PECL脚本的所在地。</div><div class="line">- *etc /*包含配置。请注意，默认的*php.ini*目录**不在**这里。</div><div class="line">- *include / php*包含头文件，这些头文件是构建附加扩展或嵌入PHP定制软件所必需的。</div><div class="line">- *lib / php*包含PEAR文件。该*LIB / PHP /建立*目录包括必要的建筑扩展名的文件，例如`和acinclude.m4`包含PHP的M4宏文件。如果我们编译了任何共享扩展名，那么这些文件将生存在*lib / php / extensions*的子目录中。</div><div class="line">- *php / man*显然包含`php`命令的手册页。</div><div class="line"></div><div class="line">如前所述，默认的*php.ini*位置不是*etc /*。您可以使用 PHP二进制文件的`--ini`选项显示位置：</div></pre></td></tr></table></figure></p>
<p>~/myphp/bin&gt; ./php –ini<br>Configuration File (php.ini) Path: /home/myuser/myphp/lib<br>Loaded Configuration File:         (none)<br>Scan for additional .ini files in: (none)<br>Additional .ini files parsed:      (none)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">你可以看到默认的*php.ini*目录是`$PREFIX/lib`（libdir），而不是`$PREFIX/etc`（sysconfdir）。您可以使用`--with-config-file-path=PATH`配置选项调整默认的*php.ini*位置。``</div><div class="line"></div><div class="line">另请注意，`make install`不会创建一个ini文件。如果你想使用一个*php.ini*文件，你有责任创建一个。例如，您可以复制默认开发配置：</div></pre></td></tr></table></figure></p>
<p>~/myphp/bin&gt; cp ~/php-src/php.ini-development ~/myphp/lib/php.ini<br>~/myphp/bin&gt; ./php –ini<br>Configuration File (php.ini) Path: /home/myuser/myphp/lib<br>Loaded Configuration File:         /home/myuser/myphp/lib/php.ini<br>Scan for additional .ini files in: (none)<br>Additional .ini files parsed:      (none)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">除了PHP二进制文件之外，*bin /*目录还包含两个重要的脚本：`phpize`和`php-config`。</div><div class="line"></div><div class="line">`phpize`相当于` ./buildconf`的扩展名。它会从* lib / php / build中*复制各种文件，并调用autoconf / autoheader。您将在下一部分中了解有关此工具的更多信息。</div><div class="line"></div><div class="line">`php-config`提供有关PHP构建的配置的信息。试试看：</div></pre></td></tr></table></figure></p>
<p>~/myphp/bin&gt; ./php-config<br>Usage: ./php-config [OPTION]<br>Options:<br>  –prefix            [/home/myuser/myphp]<br>  –includes          [-I/home/myuser/myphp/include/php -I/home/myuser/myphp/include/php/main -I/home/myuser/myphp/include/php/TSRM -I/home/myuser/myphp/include/php/Zend -I/home/myuser/myphp/include/php/ext -I/home/myuser/myphp/include/php/ext/date/lib]<br>  –ldflags           [ -L/usr/lib/i386-linux-gnu]<br>  –libs              [-lcrypt   -lresolv -lcrypt -lrt -lrt -lm -ldl -lnsl  -lxml2 -lxml2 -lxml2 -lcrypt -lxml2 -lxml2 -lxml2 -lcrypt ]<br>  –extension-dir     [/home/myuser/myphp/lib/php/extensions/debug-zts-20100525]<br>  –include-dir       [/home/myuser/myphp/include/php]<br>  –man-dir           [/home/myuser/myphp/php/man]<br>  –php-binary        [/home/myuser/myphp/bin/php]<br>  –php-sapis         [ cli cgi]<br>  –configure-options [–prefix=/home/myuser/myphp –enable-debug –enable-maintainer-zts]<br>  –version           [5.4.16-dev]<br>  –vernum            [50416]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">该脚本类似于linux发行版使用的`pkg-config`脚本。在扩展构建过程中调用它来获取有关编译器选项和路径的信息。您还可以使用它快速获取有关构建的信息，例如您的配置选项或默认扩展名。该信息也由 `.php -i`（phpinfo）提供，但`php-config`以更简单的形式提供（可以由自动化工具轻松使用）。</div><div class="line"></div><div class="line">## 运行测试套件</div><div class="line"></div><div class="line">如果`make`命令成功完成，它将打印一个消息，鼓励您运行`make test`：</div></pre></td></tr></table></figure></p>
<p>Build complete.<br>Don’t forget to run ‘make test’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">`make test`将针对我们的测试套件运行PHP CLI二进制文件，该测试套件位于PHP源代码树的不同*测试/*目录中。由于默认构建运行在大约9000个测试中（对于最小版本而言更少），更多如果启用其他扩展，则可能需要几分钟时间。该`make test`命令当前不平行，所以指定` -jN`选项不会使其更快。</div><div class="line"></div><div class="line">如果这是您第一次在平台上编译PHP，我们建议您运行测试套件。根据您的操作系统和构建环境，您可能会通过运行测试发现PHP中的错误。如果有任何故障，脚本会询问您是否要向我们的质量检查平台发送报告，这将使得贡献者能够分析故障。请注意，有一些失败的测试是很正常的，你的构建可能会很好，只要你没有看到几十个失败。</div><div class="line"></div><div class="line">该`化妆 测试`命令内部调用的`运行tests.php`使用CLI二进制文件。您可以运行 `sapi/cli/php run-tests.php --help`来显示此脚本接受的选项列表。</div><div class="line"></div><div class="line">如果您手动运行`run-tests.php`，则需要指定`-p`或`-P`选项（或丑陋的环境变量）：</div></pre></td></tr></table></figure></p>
<p>~/php-src&gt; sapi/cli/php run-tests.php -p <code>pwd</code>/sapi/cli/php<br>~/php-src&gt; sapi/cli/php run-tests.php -P<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">`-p`用于显式指定要测试的二进制文件。请注意，为了正确运行所有测试，这应该是一个绝对路径（或者独立于它所调用的目录）。`-P`是使用` run-tests.php`调用的二进制文件的快捷方式。在上述示例中，两种方法是相同的。</div><div class="line"></div><div class="line">而不是运行整个测试套件，您也可以通过将它们作为参数传递给`run-tests.php`来将其限制在某些目录中 。例如只测试Zend引擎，反射扩展和数组函数：</div></pre></td></tr></table></figure></p>
<p>~/php-src&gt; sapi/cli/php run-tests.php -P Zend/ ext/reflection/ ext/standard/tests/array/<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">这是非常有用的，因为它允许您快速运行与您的更改相关的测试套件的部分。例如，如果您正在进行语言修改，您可能不关心扩展测试，并且只想验证Zend引擎是否仍然正常工作。</div><div class="line"></div><div class="line">您不需要显式地使用`run-tests.php`来传递选项或限制目录。相反，您可以使用 `TESTS`变量通过`make 测试`传递其他参数。例如相当于以前的命令将是：</div></pre></td></tr></table></figure></p>
<p>~/php-src&gt; make test TESTS=”Zend/ ext/reflection/ ext/standard/tests/array/“<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">稍后我们将详细介绍一下`run-tests.php`系统，特别是还要讨论如何编写自己的测试以及如何调试测试失败。</div><div class="line"></div><div class="line">## 修复编译问题和`make clean`</div><div class="line"></div><div class="line">您可能会认为`make`执行增量版本，即它不会重新编译所有文件，而只能 从上次调用以来更改的`.c`文件。这是缩短构建时间的好方法，但并不总能很好地工作：例如，如果您修改头文件中的结构，则`make`将不会自动重新编译 使用该标题的所有`.c`文件，从而导致破碎的建筑。</div><div class="line"></div><div class="line">如果在运行`make`或生成的二进制文件时遇到奇怪错误（例如，如果`make 测试`在运行第一个测试之前崩溃），则应该尝试运行`make clean`。这将删除所有编译的对象，从而强制下一个`make`调用执行完整的构建。</div><div class="line"></div><div class="line">有时您还需要在更改`./configure`选项后运行`make clean`。如果只启用附加扩展，增量版本应该是安全的，但是更改其他选项可能需要完全重建。``</div><div class="line"></div><div class="line">通过`make distclean`可以获得更积极的清洁目标。这将执行正常清理，但也会回滚`./configure`命令调用带来的任何文件。它将删除配置缓存，Makefile，配置头和各种其他文件。顾名思义，这个目标是“清理分发”，所以它主要是由发行经理使用的。</div><div class="line"></div><div class="line">编译问题的另一个原因是修改`config.m4`文件或其他作为PHP构建系统的文件。如果这样的文件被更改，则需要重新运行`./buildconf`脚本。如果你自己做修改，你可能会记得运行命令，但是如果它作为`git pull`（或其他一些更新命令）的一部分发生，那么问题可能不那么明显。</div><div class="line"></div><div class="line">如果遇到任何奇怪的编译问题，这些问题不能通过`make clean`来解决，那么运行 `./buildconf --force`就可以解决问题。为了避免之前输出以前的`./configure`选项，您可以使用`./config.nice`脚本（包含最后一个`./configure`调用）：</div></pre></td></tr></table></figure></p>
<p>~/php-src&gt; make clean<br>~/php-src&gt; ./buildconf –force<br>~/php-src&gt; ./config.nice<br>~/php-src&gt; make -jN<br>```</p>
<p>PHP提供的最后一个清理脚本是<code>./vcsclean</code>。如果您从git中检出源代码，这将只起作用。它有效地归结为调用<code>git clean -X -f -d</code>，这将删除被git忽略的所有未跟踪的文件和目录。你应该谨慎使用。</p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2017-10-18T13:45:15.000Z" itemprop="dateUpdated">2017-10-18 21:45:15</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/2017/10/18/10/" target="_blank" rel="external">http://www.maksim.website/2017/10/18/10/</a>
        
    </div>
    <footer>
        <a href="http://www.maksim.website">
            <img src="/img/avatar.jpg" alt="Maksim">
            Maksim
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.maksim.website/2017/10/18/10/&title=《《PHP internals Book》 介绍》 — Maksim's Website&pic=http://www.maksim.website/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.maksim.website/2017/10/18/10/&title=《《PHP internals Book》 介绍》 — Maksim's Website&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.maksim.website/2017/10/18/10/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《《PHP internals Book》 介绍》 — Maksim's Website&url=http://www.maksim.website/2017/10/18/10/&via=http://www.maksim.website" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.maksim.website/2017/10/18/10/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017/10/18/1/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">PHP基础解惑： =与==、===的区别</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/10/16/cjc4mwipz002q2qrdvpd83juv/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">PHP页面静态化</h4>
      </a>
    </div>
  
</nav>



    











</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/" alt="打赏二维码">
        </div>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>Maksim &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://www.maksim.website/2017/10/18/10/&title=《《PHP internals Book》 介绍》 — Maksim's Website&pic=http://www.maksim.website/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://www.maksim.website/2017/10/18/10/&title=《《PHP internals Book》 介绍》 — Maksim's Website&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://www.maksim.website/2017/10/18/10/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《《PHP internals Book》 介绍》 — Maksim's Website&url=http://www.maksim.website/2017/10/18/10/&via=http://www.maksim.website" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://www.maksim.website/2017/10/18/10/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByUlEQVR42u3aS27DMAwFwN7/0i7QbRzjkZRlFxitjAR1hl0Q/OjnJz7H30k+Pz5O9Z0LDi4u7ph7XJ7PV38+f/vk+vPk25OQcHFxN3KvE811AMnfJsFEyQ4XF/dl3Ovnb4ElAePi4v5f7jdENdk9kHdxcXFb3Lw5qRYxeVJb3Kvh4uIOuNWB6R3PN853cXFxi9yjePIyKCliyr+Oi4u7hXv9omrTUg2yOZDFxcW9mbs2PSUrk14lg4uLu5+bv65H75U1J/8+XFzcLdxqQdND96Y1zYtZuLi4i7gJvdq0VEPNly64uLg7udXIkvRUXdkWWiZcXNybuUnL0VurNMcfvdoHFxd3EXeyXu0VNHnqPAkeFxd3Ozdfu87XKvm1DFxc3Ge5kwFHtVTKx6+4uLj7ufnS4o6rFdVgcHFx93AnFynyRWwvneHi4j7Lrd5tyMua+VUMXFzcp7jVsWm+Ip00V6NVCi4u7pquJAqsmuCqQ9jJyhYXF3ctN086qy5m5Q3Pya/g4uJu5E6GpPnVjQWlDC4u7su4efvUS3aRDRcX95Xc3sijOl7BxcV9A3fVJa3JYDRayuLi4m7h9jqOvMlJipjJFRBcXNyl3F9ghmzDGs8MUAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
